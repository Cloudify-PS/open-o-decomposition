
node_types:
    TrafficIn:
        derived_from: tosca.nodes.nfv.CP
        requirements:
            virtual_link:
                capability: virtual_linkable
                node: EnterpriseLAN
     
    TrafficOut:
        derived_from: tosca.nodes.nfv.CP
        requirements:
            virtual_link:
                capability: virtual_linkable
                node: DCLAN
            
    ThinCPE:
        derived_from: tosca.nodes.nfv.VNF
        requirements:
            virtual_link1:
                capability: virtual_linkable
                node: EnterpriseLAN
            virtual_link2:
                capability: virtual_linkable
                node: EnterpriseToPOP
        capabilities:
            lan_port:
                type: tosca.capabilities.nfv.Forwarder
            vcpe_port:
                type: tosca.capabilities.nfv.Forwarder

    VCPE:
        derived_from: tosca.nodes.nfv.CP
        requirements:
            virtual_link1:
                capability: virtual_linkable
                node: POPLAN
            virtual_link2: 
                capability: virtual_linkable
                node: EnterpriseToPOP
        capabilities:
            thincpe_port:
                type: tosca.capabilities.nfv.Forwarder
            lan_port:
                type: tosca.capabilities.nfv.Forwarder

    VFirewall:
        derived_from: tosca.nodes.nfv.VNF
        requirements:
            virtual_link1:
                capability: virtual_linkable
                node: POPLAN
            virtual_link2:
                capability: virtual_linkable
                node: WAN
        capabilities:
            secured_port:
                type: tosca.capabilities.nfv.Forwarder
            unsecured_port:
                type: tosca.capabilities.nfv.Forwarder

    DCGateway:
        derived_from: tosca.nodes.nfv.VNF
        requirements:
            virtual_link1:
                capability: virtual_linkable
                node: DCLAN
            virtual_link2:
                capability: virtual_linkable
                node: WAN
        capabilities:
            internal_port:
                type: tosca.capabilities.nfv.Forwarder
            external_port:
                type: tosca.capabilities.nfv.Forwarder

    EnterpriseLAN:
        derived_from: tosca.nodes.nfv.VL.ELAN
        capabilities:
            virtual_linkable:
                type: tosca.capabilities.nfv.VirtualLinkable
                occurrences: 2

    EnterpriseToPOP:
        derived_from: tosca.nodes.nfv.VL.ELine
        capabilities:
            virtual_linkable:
                type: tosca.capabilities.nfv.VirtualLinkable
                occurrences: 2

    POPLAN:
        derived_from: tosca.nodes.nfv.VL.ELAN
        capabilities:
            virtual_linkable:
                type: tosca.capabilities.nfv.VirtualLinkable
                occurrences: 2

    WAN:
        derived_from: tosca.nodes.nfv.VL.ELAN
        capabilities:
            virtual_linkable:
                type: tosca.capabilities.nfv.VirtualLinkable
                occurrences: 2

    DCLAN:
        derived_from: tosca.nodes.nfv.VL.ELAN
        capabilities:
            virtual_linkable:
                type: tosca.capabilities.nfv.VirtualLinkable
                occurrences: 2

    DatabaseServer:
        derived_from: tosca.nodes.Database
        requirements:
            virtual_link_1:
                capability: virtual_linkable
                node: DCLAN
        capabilities:
            lan_port:
                type: tosca.capabilities.nfv.Forwarder

    ForwardingPath:
        derived_from: tosca.nodes.nfv.FP 
        description: Main forwarding graph
        requirements:
            forwarder1:
                capability: virtual_linkable
                node: TrafficIn
            forwarder2:
                capability: lan_port
                node: ThinCPE
            forwarder3:
                capability: vcpe_port
                node: ThinCPE
            forwarder4:
                capability: thincpe_port
                node: VCPE
            forwarder5:
                capability: lan_port
                node: VCPE
            forwarder6:
                capability: secured_port
                node: VFirewall
            forwarder7:
                capability: unsecured_port
                node: VFirewall
            forwarder8:
                capability: external_port
                node: DCGateway
            forwarder9:
                capability: internal_port
                node: DCGateway
            forwarder10:
                capability: lan_port
                node: DatabaseServer
            forwarder11:
                capability: virtual_linkable
                node: TrafficOut

group_types:
    VNFFG:
        derived_from: tosca.groups.nfv.VNFFG
        description: Forwarding graph group
        members: [ForwardingPath]
        properties:
            vl: [EnterpriseLAN, EnterpriseToPOP, POPLAN, WAN, DCLAN]
            vnf: [ThinCPE, VCPE, VFirewall, DCGateway, DatabaseServer]
